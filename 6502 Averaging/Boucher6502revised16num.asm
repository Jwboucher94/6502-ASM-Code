; Set number of values, binary logarithm, values
N = 15
BL = 4
STORE = $0200
CARRYSTORE = $0201
NUM0 = $9F
NUM1 = $35
NUM2 = $FD
NUM3 = $CF
NUM4 = $CC
NUM5 = $A2
NUM6 = $AF
NUM7 = $BC
NUM8 = $9F
NUM9 = $53
NUM0A = $DD
NUM0B = $FC
NUM0C = $CC
NUM0D = $2A
NUM0E = $FA
NUM0F = $2D

NUM0S = $0100

; Load values and push onto stack
LDX #0
LDA #NUM0
STA NUM0S,X
INX
PHA
LDA #NUM1
STA NUM0S,X
INX
PHA
LDA #NUM2
STA NUM0S,X
INX
PHA
LDA #NUM3
STA NUM0S,X
INX
PHA
LDA #NUM4
STA NUM0S,X
INX
PHA
LDA #NUM5
STA NUM0S,X
INX
PHA
LDA #NUM6
STA NUM0S,X
INX
PHA
LDA #NUM7
STA NUM0S,X
INX
PHA

LDA #NUM8
STA NUM0S,X
INX
PHA
LDA #NUM9
STA NUM0S,X
INX
PHA
LDA #NUM0A
STA NUM0S,X
INX
PHA
LDA #NUM0B
STA NUM0S,X
INX
PHA
LDA #NUM0C
STA NUM0S,X
INX
PHA
LDA #NUM0D
STA NUM0S,X
INX
PHA
LDA #NUM0E
STA NUM0S,X
INX
PHA
LDA #NUM0F
STA NUM0S,X
INX
PHA


; Steps for addition
LDA #0

ADDLOOP:
PLA
ADC STORE
BCC SKIPCARRY
INC CARRYSTORE
CLC
CLV
SKIPCARRY:
STA STORE

ADDCHECK: 
CLC
TSX
CPX #$FF
BNE ADDLOOP 

; set x to 0, jump to check if division is needed
LDX #0 
LDY #0
JMP BLCHECK

; only comes here if BL > 0

DIVIDE:
INY
LDA CARRYSTORE
CLC
ROR
BCC NOCARRY
SEC
NOCARRY:
STA CARRYSTORE
LDA STORE
ROR
CLC
STA STORE

BLCHECK:
CPY #BL
BNE DIVIDE


; start replacing numbers
LDX #0
LDY #0

REPLACEMENT:
LDA STORE
CMP NUM0S,X
BEQ CHECKCOUNT
BCC CHECKCOUNT
LDA #00
STA NUM0S,X

CHECKCOUNT:
CPX #N
BEQ FINISHED
INX
JMP REPLACEMENT

FINISHED:
BRK